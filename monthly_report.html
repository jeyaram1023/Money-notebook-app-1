<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Expense Report - Money Notebook</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #000428, #004e92);
      color: #ffffff;
      padding: 20px;
    }

    .container {
      max-width: 1000px;
      margin: auto;
      padding: 30px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      backdrop-filter: blur(15px);
      box-shadow: 0 8px 32px 0 rgba( 31, 38, 135, 0.37 );
      border: 1px solid rgba( 255, 255, 255, 0.18 );
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      margin-bottom: 30px;
      background: linear-gradient(to right, #00f260, #0575e6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    select, button {
      padding: 10px;
      border-radius: 10px;
      border: none;
      font-size: 14px;
      background: #ffffff10;
      color: white;
      transition: 0.3s;
      backdrop-filter: blur(5px);
    }

    select:focus, button:focus {
      outline: none;
      box-shadow: 0 0 5px #00ffe0;
    }

    button {
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      cursor: pointer;
    }

    button:hover {
      background: linear-gradient(to right, #ff4b2b, #ff416c);
      transform: scale(1.05);
    }

    select[multiple] {
      height: 100px;
    }

    .label {
      text-align: center;
      margin: 20px 0;
      font-size: 18px;
      color: #00ffe0;
    }

    canvas {
      background: rgba(0, 0, 0, 0.2);
      padding: 20px;
      border-radius: 12px;
    }

    @media (max-width: 600px) {
      .controls {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Expense Report</h1>

    <div class="controls">
      <select id="monthSelect">
        <option value="">Select Month</option>
      </select>

      <select id="daySelect">
        <option value="">Select Day</option>
      </select>

      <select id="categorySelect" multiple>
        <option value="Food">Food</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Bills">Bills</option>
        <option value="Travel">Travel</option>
        <option value="Shopping">Shopping</option>
        <option value="Other">Other</option>
      </select>

      <select id="graphType">
        <option value="bar">Bar</option>
        <option value="line">Line</option>
        <option value="pie">Pie</option>
        <option value="doughnut">Doughnut</option>
        <option value="radar">Radar</option>
      </select>

      <button onclick="renderGraph()">Show Graph</button>
    </div>

    <div class="label" id="selectedLabel"></div>
    <canvas id="expenseChart"></canvas>
  </div>

  <script>
    const ctx = document.getElementById('expenseChart').getContext('2d');
    let chart;

    const sampleData = [
      { date: '2025-06-01', category: 'Food', amount: -200 },
      { date: '2025-06-01', category: 'Travel', amount: -50 },
      { date: '2025-06-02', category: 'Food', amount: -150 },
      { date: '2025-06-03', category: 'Bills', amount: -400 },
      { date: '2025-06-03', category: 'Shopping', amount: -600 },
      { date: '2025-06-05', category: 'Other', amount: -90 },
    ];

    const monthSelect = document.getElementById('monthSelect');
    const daySelect = document.getElementById('daySelect');
    const categorySelect = document.getElementById('categorySelect');
    const graphTypeSelect = document.getElementById('graphType');
    const selectedLabel = document.getElementById('selectedLabel');

    const getUniqueMonths = () => {
      const months = [...new Set(sampleData.map(t => t.date.slice(0, 7)))];
      months.forEach(month => {
        const opt = document.createElement('option');
        opt.value = month;
        opt.textContent = month;
        monthSelect.appendChild(opt);
      });
    };

    const updateDays = () => {
      daySelect.innerHTML = '<option value="">Select Day</option>';
      const selectedMonth = monthSelect.value;
      const days = [...new Set(sampleData.filter(t => t.date.startsWith(selectedMonth)).map(t => t.date))];
      days.forEach(day => {
        const opt = document.createElement('option');
        opt.value = day;
        opt.textContent = day;
        daySelect.appendChild(opt);
      });
    };

    const renderGraph = () => {
      const selectedMonth = monthSelect.value;
      const selectedDay = daySelect.value;
      const selectedCategories = Array.from(categorySelect.selectedOptions).map(o => o.value);
      const type = graphTypeSelect.value;

      let filtered = sampleData.filter(t => t.amount < 0);

      if (selectedMonth) {
        filtered = filtered.filter(t => t.date.startsWith(selectedMonth));
      }
      if (selectedDay) {
        filtered = filtered.filter(t => t.date === selectedDay);
      }
      if (selectedCategories.length > 0) {
        filtered = filtered.filter(t => selectedCategories.includes(t.category));
      }

      const grouped = {};
      filtered.forEach(t => {
        if (!grouped[t.category]) grouped[t.category] = 0;
        grouped[t.category] += Math.abs(t.amount);
      });

      const labels = Object.keys(grouped);
      const data = Object.values(grouped);
      const backgroundColors = ['#ff4d4d', '#ff9800', '#2196f3', '#8e24aa', '#ff5722', '#00ffe0'];

      if (chart) chart.destroy();

      chart = new Chart(ctx, {
        type: type,
        data: {
          labels: labels,
          datasets: [{
            label: 'Expenses',
            data: data,
            backgroundColor: backgroundColors,
            borderColor: '#ffffff',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              labels: { color: '#ffffff' }
            },
            tooltip: {
              callbacks: {
                label: context => `â‚¹${context.parsed}`
              }
            }
          },
          scales: type === 'radar' || type === 'pie' || type === 'doughnut' ? {} : {
            x: { ticks: { color: '#ffffff' }, grid: { color: '#444' } },
            y: { ticks: { color: '#ffffff' }, grid: { color: '#444' }, beginAtZero: true }
          }
        }
      });

      selectedLabel.textContent = `Showing data for ${selectedDay || selectedMonth || 'All Dates'} | Categories: ${selectedCategories.length ? selectedCategories.join(', ') : 'All'}`;
    };

    monthSelect.addEventListener('change', updateDays);
    window.onload = getUniqueMonths;
  </script>
</body>
</html>
